{% liquid
  if section.settings.menu.links == blank
    assign main_menu_linklist = linklists[section.settings.menu].links
  else
    assign main_menu_linklist = section.settings.menu.links
  endif
%}

{% stylesheet %}
  .js-toggle-menu.active-submenu svg {
    transform: rotate(180deg);
    transition: transform 0.3s;
  }
{% endstylesheet %}

<!-- Footer Navigation for small screens -->
<footer class="fixed bottom-0 left-0 right-0 bg-white shadow-lg lg:hidden z-50 h-fit">
  <!-- search box dropdown for small screens -->
  <div id="mobile-footer-search-box" class="container mx-auto px-4 py-8 bg-[#c42764] text-white hidden xl:hidden">
    <div class="flex items-center text-white">
      <textarea
        class="focus:outline-none border-gray-300 bg-transparent font-semibold text-sm pl-4 w-full"
        type="text"
        placeholder="I'm searching for ..."
      ></textarea>
      {% render 'icon-search' %}
    </div>
  </div>

  <div
    class="container mx-auto px-4 py-2 flex justify-around items-center relative bg-[#c42764] text-white rounded-t-3xl shadow-lg"
  >
    <a href="{{ routes.cart_url }}" class="flex flex-col items-center hover:text-white">
      {% render 'icon-cart' %}
      <span class="text-xs">Cart</span>
    </a>

    <!-- space in center bar -->
    <span class="flex flex-col items-center hover:text-white"> </span>

    <!-- Center Circular Icon -->
    <div
      class="absolute bg-white -top-10 left-1/2 transform -translate-x-1/2 rounded-full border-b border-gray-200 p-4 flex items-center justify-center"
    >
      <button class="flex mobile-footer-burger border-none rounded-md focus:outline-none flex-col items-center">
        <div class="bg-[#c42764] h-10 w-10 rounded-full justify-center items-center flex">
          {% render 'icon-menu' %}
        </div>
      </button>
    </div>

    <!-- Search Icon -->
    <div class="flex flex-col items-center hover:text-white">
      <button
        id="footer-search-toggle"
        class="border-none rounded-md focus:outline-none flex flex-col items-center hover:text-white"
      >
        {% render 'icon-search' %}
        <span class="text-xs">Search</span>
      </button>
    </div>
  </div>
</footer>

<div class="mobile-footer-menu relative z-50 hidden">
  <div class="mobile-footer-backdrop fixed inset-0 bg-gray-800 opacity-25"></div>
  <nav
    class="fixed top-0 left-0 bottom-0 flex flex-col w-full max-w-sm pt-6 bg-white shadow-lg overflow-y-auto list-none rounded-tr-2xl rounded-br-2xl"
  >
    <!-- Header -->
    <div class="flex items-center mb-8 px-5 border-b border-gray-200 pb-4">
      <a class="mr-auto text-xl font-bold leading-none text-[#c42764]" href="#">
        {{ shop.name }}
      </a>
      <button class="mobile-footer-close hover:scale-110 transition-transform">
        {% render 'icon-close' %}
      </button>
    </div>

    <!-- Menu -->
    {% for link in main_menu_linklist %}
      {% if link.links != blank %}
        <li class="relative w-full">
          <button
            class="group text-sm px-6 flex flex-row items-center justify-between w-full h-12 border-b border-gray-100 hover:bg-gray-50 transition-colors js-toggle-footer-menu {% if link.active or link.child_active %}text-white font-bold bg-[#c42764]{% endif %}"
            data-target="footer-menu-{{ link.title | handleize }}"
            type="button"
          >
            <span>{{ link.title }}</span>
            <span class="transform transition-transform group-[.open]:rotate-180">
              {% render 'icon-chevron-down' %}
            </span>
          </button>

          <div
            class="submenu w-full bg-white text-gray-700 hidden overflow-hidden transition-all duration-300"
            id="footer-menu-{{ link.title | handleize }}"
          >
            <ul class="pl-4 border-l border-gray-200">
              {% for childlink in link.links %}
                <li>
                  {% if childlink.links != blank %}
                    <button
                      class="group text-sm px-6 flex flex-row items-center justify-between w-full h-11 hover:bg-gray-50 transition-colors js-toggle-footer-menu"
                      data-target="footer-menu-{{ childlink.title | handleize }}"
                      type="button"
                    >
                      <span>{{ childlink.title }}</span>
                      <span class="transform transition-transform group-[.open]:rotate-180">
                        {% render 'icon-chevron-down' %}
                      </span>
                    </button>

                    <div
                      class="submenu w-full bg-gray-50 text-gray-600 hidden overflow-hidden transition-all duration-300"
                      id="footer-menu-{{ childlink.title | handleize }}"
                    >
                      <ul class="pl-6 border-l border-gray-200">
                        {% for grandchild in childlink.links %}
                          <li>
                            <a class="block py-2 px-6 hover:text-[#c42764] transition-colors" href="{{ grandchild.url }}">
                              {{ grandchild.title }}
                            </a>
                          </li>
                        {% endfor %}
                      </ul>
                    </div>
                  {% else %}
                    <a class="block py-2 px-6 hover:text-[#c42764] transition-colors" href="{{ childlink.url }}">
                      {{ childlink.title }}
                    </a>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          </div>
        </li>
      {% else %}
        <li class="w-full">
          <a
            class="text-sm flex items-center px-6 h-12 border-b border-gray-100 hover:bg-gray-50 transition-colors {% if link.active %}text-white font-bold bg-[#c42764]{% else %}text-gray-500{% endif %}"
            href="{{ link.url }}"
          >
            {{ link.title }}
          </a>
        </li>
      {% endif %}
    {% endfor %}

    <!-- Footer -->
    <div class="mt-auto bg-[#c42764] py-3 rounded-t-xl">
      <p class="text-xs text-center text-gray-100 tracking-wide">
        Â© 2024 {{ shop.name }}
      </p>
    </div>
  </nav>
</div>


{% schema %}
{
  "name": "Mobile Navigational Bar",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "Mobile Menu",
      "default": "main-menu"
    }
  ]
}
{% endschema %}
