{% liquid
  assign section_id = section.id
  assign main_product = all_products[section.settings.main_product]
  assign sub_info_type = section.settings.sub_info_type
%}
<section id="shopify-section-{{ section_id }}" class="featured-product-group max-w-7xl mx-auto py-8 px-0 md:px-4">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-stretch">
    
    <!-- المنتج الكبير -->
    {% if main_product %}
      <div class="relative main-product h-full rounded-lg overflow-hidden">
        {% render 'image',
          image: main_product.featured_image,
          class: 'w-full h-full object-cover',
          width: 800,
          height: 800,
          crop: 'center',
          alt: main_product.title
        %}
        <div class="absolute inset-0 flex flex-col justify-center items-start p-6 md:p-12">
          <h2 class="text-white text-2xl md:text-3xl font-bold mb-4">
            High-end watches
          </h2>
          <a 
            href="{{ main_product.url }}"
            class="bg-white text-black font-medium px-6 py-2 rounded-full shadow hover:bg-gray-100 transition"
          >
            See Collection
          </a>
        </div>
      </div>
    {% endif %}

    <!-- المنتجات الجانبية -->
    <div class="product-list grid grid-rows-3 gap-4 h-full">
      {% for block in section.blocks %}
        {% liquid
          assign product = all_products[block.settings.product]
        %}
        {% if product %}
          <div class="flex items-center justify-between bg-white border-b-0 p-4">
            <!-- النص -->
            <div class="flex-1 pr-4">
              <p class="text-xs text-gray-500 font-semibold uppercase">
                {{ product.vendor }}
              </p>
              <h3 class="text-sm font-bold leading-tight">
                <a href="{{ product.url }}">{{ product.title }}</a>
              </h3>
              <p class="text-green-500 text-xs mt-1">✔ 1-2 Days Delivery</p>
              <p class="text-gray-800 font-semibold mt-1">{{ product.price | money }}</p>
            </div>
            <!-- صورة المنتج -->
            <a href="{{ product.url }}" class="w-16 md:w-20 flex-shrink-0">
              {% render 'image',
                image: product.featured_image,
                class: 'w-full h-auto object-contain rounded',
                width: 150,
                height: 150,
                crop: 'center',
                alt: product.title
              %}
            </a>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

{% comment %} <section id="shopify-section-{{ section_id }}" class="featured-product-group max-w-7xl mx-auto py-8 px-0 md:px-4">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-stretch">
    <!-- المنتج الكبير -->
    {% if main_product %}
      <div class="main-product h-full">
        <a href="{{ main_product.url }}">
          {% render 'image',
            image: main_product.featured_image,
            class: 'w-full h-full object-cover rounded-lg shadow-lg',
            width: 800,
            height: 800,
            crop: 'center',
            alt: main_product.title
          %}
        </a>
      </div>
    {% endif %}

    <!-- المنتجات الجانبية -->
    <div class="product-list grid grid-rows-3 gap-4 h-full">
      {% for block in section.blocks %}
        {% liquid
          assign product = all_products[block.settings.product]
        %}
        {% if product %}
          <div class="flex items-center bg-white rounded-lg shadow p-3">
            <!-- صورة المنتج -->
            <a href="{{ product.url }}" class="flex-shrink-0">
              {% render 'image',
                image: product.featured_image,
                class: 'w-full h-full object-cover rounded mr-4',
                width: 150,
                height: 150,
                crop: 'center',
                alt: product.title
              %}
            </a>
            <!-- النص -->
            <div class="flex-1 overflow-hidden">
              <h3 class="text-sm font-semibold truncate">
                <a href="{{ product.url }}">{{ product.title }}</a>
              </h3>
              {% if sub_info_type == 'description' %}
                <p class="text-gray-600 text-xs line-clamp-2">
                  {% if product.description != blank %}
                    {{ product.description | strip_html | truncate: 60 }}
                  {% else %}
                    no description
                  {% endif %}
                </p>
              {% elsif sub_info_type == 'vendor' %}
                <p class="text-gray-500 text-xs">{{ product.vendor }}</p>
              {% endif %}
              <p class="text-gray-800 font-medium mt-1">{{ product.price | money }}</p>
            </div>
            <!-- زر -->
            <a
              href="{{ product.url }}"
              aria-label="view {{ product.title }}"
              class="ml-3 bg-black text-white text-xs px-3 py-1 rounded hover:bg-gray-800"
            >
              عرض
            </a>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section> {% endcomment %}

{% schema %}
{
  "name": "Featured Product Group",
  "settings": [
    {
      "type": "product",
      "id": "main_product",
      "label": "Main Product (Large Image)"
    },
    {
      "type": "select",
      "id": "sub_info_type",
      "label": "Sub Product Extra Info",
      "default": "description",
      "options": [
        { "value": "description", "label": "Show Description" },
        { "value": "vendor", "label": "Show Vendor" },
        { "value": "none", "label": "Show Nothing" }
      ]
    }
  ],
  "blocks": [
    {
      "type": "product_block",
      "name": "Product",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Select Product"
        }
      ]
    }
  ],
  "max_blocks": 3,
  "presets": [
    {
      "name": "Featured Product Group",
      "category": "Products",
      "blocks": [{ "type": "product_block" }, { "type": "product_block" }, { "type": "product_block" }]
    }
  ]
}
{% endschema %}
